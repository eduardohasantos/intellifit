{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>IntelliFit - Progresso</title>
  <link rel="stylesheet" href="{% static 'global/css/global.css' %}">
  <link rel="stylesheet" href="{% static 'progress/css/progress.css' %}">
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
  <header class="header">
    <a href="{% url 'dashboard' %}" class="logo-container">
      <h1 class="site-name">IntelliFit</h1>
    </a>
    <nav class="header-actions">
      <a href="{% url 'edit_account' %}" class="nav-btn"><i data-feather="user"></i> Editar Perfil</a>
      <a href="{% url 'delete_account' %}" class="nav-btn delete-btn"><i data-feather="trash-2"></i> Excluir Perfil</a>
      <form action="{% url 'logout' %}" method="post" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="nav-btn logout-btn"><i data-feather="log-out"></i> Sair</button>
      </form>
    </nav>
  </header>

  <main class="main-content">
    <div class="dashboard-container">
      {% if messages %}
        {% for message in messages %}
          <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}

      {% if all_entries %}
        {% with latest_entry=all_entries.first %}
        <div class="welcome-section">
          <h2 class="welcome">Último Registro do Progresso</h2>
          <p class="welcome-subtitle">Registrado em: {{ latest_entry.date|date:"d/m/Y" }}</p>
        </div>
        <section class="cards">
          <div class="card">
            <i data-feather="trending-up"></i>
            <h3>Peso</h3>
            <p class="data">{{ latest_entry.weight|floatformat:2 }} kg</p>
          </div>
          <div class="card">
            <i data-feather="droplet"></i>
            <h3>Água</h3>
            <p class="data">{{ latest_entry.water_ml }} ml</p>
          </div>
          <div class="card">
            <i data-feather="activity"></i>
            <h3>Calorias</h3>
            <p class="data">{{ latest_entry.calories }} kcal</p>
          </div>
        </section>
        {% endwith %}
      {% else %}
        <div class="welcome-section">
          <h2 class="welcome">Bem-vindo(a)!</h2>
          <p class="welcome-subtitle">Você ainda não registrou nenhum progresso.</p>
        </div>
      {% endif %}

      <section class="form-section">
        <h2 class="section-title">Adicionar Novo Registro</h2>
        <form method="POST" action="{% url 'progress:progress_page' %}" class="progress-form">
          {% csrf_token %}
          <div class="form-group">
            <label for="{{ form.weight.id_for_label }}">Peso (kg)</label>
            {{ form.weight }}
          </div>
          <div class="form-group">
            <label for="{{ form.water_ml.id_for_label }}">Água (ml)</label>
            {{ form.water_ml }}
          </div>
          <div class="form-group">
            <label for="{{ form.calories.id_for_label }}">Calorias (kcal)</label>
            {{ form.calories }}
          </div>
          <button type="submit" class="btn-submit">Salvar Novo Progresso</button>
        </form>
      </section>

      {% comment %} --- ÁREA ALTERADA --- {% endcomment %}
      <section class="history-section">
        {% comment %} O TÍTULO H2 FOI REMOVIDO DAQUI {% endcomment %}
        {% if all_entries %}
          <ul class="history-list">
            {% for entry in all_entries %}
              <li class="history-item">
                {% comment %} O TEXTO SPAN FOI REMOVIDO DAQUI {% endcomment %}
                <div class="action-buttons">
                  <a href="{% url 'progress:edit_progress' entry.id %}" class="btn-action edit">Editar</a>
                  <a href="{% url 'progress:delete_progress' entry.id %}" class="btn-action delete">Excluir</a>
                </div>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </section>
      {% comment %} --- FIM DA ÁREA ALTERADA --- {% endcomment %}
    </div>
  </main>

  <script>
    feather.replace();
  </script>
</body>
</html>