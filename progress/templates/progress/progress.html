{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>IntelliFit - Progresso</title>
  <link rel="stylesheet" href="{% static 'global/css/global.css' %}">
  <link rel="stylesheet" href="{% static 'progress/css/progress.css' %}">
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <a href="{% url 'dashboard' %}" class="logo-container">
      <h1 class="site-name">IntelliFit</h1>
    </a>
    
    <nav class="header-actions">
      <a href="{% url 'edit_account' %}" class="nav-btn"><i data-feather="user"></i> Editar Perfil</a>
      <a href="{% url 'delete_account' %}" class="nav-btn delete-btn"><i data-feather="trash-2"></i> Excluir Perfil</a>
      <form action="{% url 'logout' %}" method="post" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="nav-btn logout-btn"><i data-feather="log-out"></i> Sair</button>
      </form>
    </nav>
  </header>

  <!-- Conteúdo principal -->
  <main class="main-content">
    <div class="dashboard-container">
      {% if messages %}
        {% for message in messages %}
          <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}

      {% if latest_entry %}
        <div class="welcome-section">
          <h2 class="welcome">Último Registro do Progresso</h2>
          <p class="welcome-subtitle">Registrado em: {{ latest_entry.date|date:"d/m/Y" }}</p>
        </div>

        <section class="cards">
          <div class="card">
            <i data-feather="trending-up"></i>
            <h3>Peso</h3>
            <p class="data">{{ latest_entry.weight|floatformat:2 }} kg</p>
          </div>
          <div class="card">
            <i data-feather="droplet"></i>
            <h3>Água</h3>
            <p class="data">{{ latest_entry.water_ml }} ml</p>
          </div>
          <div class="card">
            <i data-feather="activity"></i>
            <h3>Calorias</h3>
            <p class="data">{{ latest_entry.calories }} kcal</p>
          </div>
        </section>
      {% else %}
        <div class="welcome-section">
          <h2 class="welcome">Bem-vindo(a)!</h2>
          <p class="welcome-subtitle">Você ainda não registrou nenhum progresso.</p>
        </div>
      {% endif %}

      <section class="form-section">
        <h2 class="section-title">Adicionar Novo Registro</h2>
        <form method="POST" action="{% url 'progress:progress_page' %}" class="progress-form">
          {% csrf_token %}

          {% if form.errors %}
            <div class="form-errors">
              <strong>Ocorreram erros no formulário:</strong>
              <ul>
                {% for field in form %}
                  {% for error in field.errors %}
                    <li>{{ field.label }}: {{ error }}</li>
                  {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                  <li>{{ error }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          <div class="form-group">
            <label for="{{ form.weight.id_for_label }}">Peso (kg)</label>
            {{ form.weight }}
          </div>
          
          <div class="form-group">
            <label for="{{ form.water_ml.id_for_label }}">Água (ml)</label>
            {{ form.water_ml }}
          </div>
          
          <div class="form-group">
            <label for="{{ form.calories.id_for_label }}">Calorias (kcal)</label>
            {{ form.calories }}
          </div>
          
          <button type="submit" class="btn-submit">Salvar Novo Progresso</button>
        </form>
      </section>
    </div>
  </main>

  <script>
    feather.replace();
  </script>
</body>
</html>